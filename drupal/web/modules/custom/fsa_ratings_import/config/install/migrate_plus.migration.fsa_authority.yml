# Migration configuration for FSA Authorities.
id: fsa_authority
label: FSA Authorities import
migration_group: fsa
migration_tags:
  - authorities
source:
  plugin: url
  data_fetcher_plugin: http
  data_parser_plugin: json
  urls:
      - 'http://api.ratings.food.gov.uk/Authorities'
  headers:
    accept: 'application/json'
    x-api-version: '2'
  item_selector: authorities
  fields:
      -
        name: LocalAuthorityId
        selector: LocalAuthorityId
      -
        name: LocalAuthorityIdCode
        selector: LocalAuthorityIdCode
      -
        name: Name
        selector: Name
      -
        name: Url
        selector: Url
      -
        name: Email
        selector: Email
      -
        name: RegionName
        selector: RegionName
  ids:
      LocalAuthorityId:
        type: integer

destination:
  plugin: entity:fsa_authority

process:
  type:
    plugin: default_value
    default_value: fsa_authority
  id: LocalAuthorityIdCode
  name: Name
  field_url: Url
  field_email: Email
  field_regionname:
    plugin: entity_generate
    source: RegionName
    entity_type: taxonomy_term
    bundle_key: vid
    bundle: fhrs_region
    value_key: name
  uid:
    plugin: default_value
    default_value: 0
